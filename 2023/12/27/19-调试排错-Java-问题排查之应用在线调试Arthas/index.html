<!DOCTYPE html>
<html lang='zh-CN'>

<head>
  <meta name="generator" content="Hexo 7.0.0">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.21.0">
  <meta charset="utf-8">
  

  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel='dns-prefetch' href='https://gcore.jsdelivr.net'>
  <link rel="preconnect" href="https://gcore.jsdelivr.net" crossorigin>
  <link rel='dns-prefetch' href='//unpkg.com'>

  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>19.调试排错 - Java 问题排查之应用在线调试Arthas - Hubert's Blog</title>

  
    <meta name="description" content="本文主要介绍Alibaba开源的Java诊断工具，开源到现在已经几万个点赞了，深受开发者喜爱。  Arthas简介 在学习Arthas之前，推荐先看上一篇美团技术团队的Java 动态调试技术原理及实践，这样你会对它最底层技术有个了解。可以看下文中最后有个对比图：Greys(Arthas也是基于它做的二次开发)和Java-debug-tool。  Arthas是什么Arthas 是Alibaba开">
<meta property="og:type" content="article">
<meta property="og:title" content="19.调试排错 - Java 问题排查之应用在线调试Arthas">
<meta property="og:url" content="https://hubertwongcn.github.io/2023/12/27/19-%E8%B0%83%E8%AF%95%E6%8E%92%E9%94%99-Java-%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E4%B9%8B%E5%BA%94%E7%94%A8%E5%9C%A8%E7%BA%BF%E8%B0%83%E8%AF%95Arthas/index.html">
<meta property="og:site_name" content="Hubert&#39;s Blog">
<meta property="og:description" content="本文主要介绍Alibaba开源的Java诊断工具，开源到现在已经几万个点赞了，深受开发者喜爱。  Arthas简介 在学习Arthas之前，推荐先看上一篇美团技术团队的Java 动态调试技术原理及实践，这样你会对它最底层技术有个了解。可以看下文中最后有个对比图：Greys(Arthas也是基于它做的二次开发)和Java-debug-tool。  Arthas是什么Arthas 是Alibaba开">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/HubertWongCN/image_host/img/202312271543066.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/HubertWongCN/image_host/img/202312271544902.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/HubertWongCN/image_host/img/202312271545478.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/HubertWongCN/image_host/img/202312271548630.jpg">
<meta property="article:published_time" content="2023-12-27T07:41:20.000Z">
<meta property="article:modified_time" content="2023-12-27T07:41:20.000Z">
<meta property="article:author" content="Hubert Wong">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="JVM">
<meta property="article:tag" content="调试排错">
<meta property="article:tag" content="问题排查">
<meta property="article:tag" content="Arthas">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/HubertWongCN/image_host/img/202312271543066.png">
  
  
  
  <meta name="keywords" content="Java,JVM,调试排错,问题排查,Arthas">

  <!-- feed -->
  

  
    
<link rel="stylesheet" href="/css/main.css">

  

  

  

  


  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body>
  




  <div class='l_body' id='start'>
    <aside class='l_left' layout='post'>
    

  

<header class="header"><div class="logo-wrap"><a class="title" href="/"><div class="main" ff="title">Hubert's Blog</div><div class="sub cap"> Hubert爱猫爱生活</div></a></div>

<nav class="menu dis-select"></nav>
</header>


<div class="widgets">
<widget class="widget-wrapper search"><div class="widget-body"><div class="search-wrapper" id="search"><form class="search-form"><input type="text" class="search-input" id="search-input" data-filter="/blog/" placeholder="文章搜索"><svg t="1670596976048" class="icon search-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2676" width="200" height="200"><path d="M938.2 832.6L723.8 618.1c-2.5-2.5-5.3-4.4-7.9-6.4 36.2-55.6 57.3-121.8 57.3-193.1C773.3 222.8 614.6 64 418.7 64S64 222.8 64 418.6c0 195.9 158.8 354.6 354.6 354.6 71.3 0 137.5-21.2 193.2-57.4 2 2.7 3.9 5.4 6.3 7.8L832.5 938c14.6 14.6 33.7 21.9 52.8 21.9 19.1 0 38.2-7.3 52.8-21.8 29.2-29.1 29.2-76.4 0.1-105.5M418.7 661.3C284.9 661.3 176 552.4 176 418.6 176 284.9 284.9 176 418.7 176c133.8 0 242.6 108.9 242.6 242.7 0 133.7-108.9 242.6-242.6 242.6" p-id="2677"></path></svg></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div></div></widget>


<widget class="widget-wrapper toc single" id="data-toc"><div class="widget-header cap dis-select"><span class="name">19.调试排错 - Java 问题排查之应用在线调试Arthas</span></div><div class="widget-body fs14"><div class="doc-tree active"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Arthas%E7%AE%80%E4%BB%8B"><span class="toc-text">Arthas简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Arthas%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">Arthas是什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arthas%E8%83%BD%E8%A7%A3%E5%86%B3%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98"><span class="toc-text">Arthas能解决什么问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arthas%E8%B5%84%E6%BA%90%E6%8E%A8%E8%8D%90"><span class="toc-text">Arthas资源推荐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arthas%E5%9F%BA%E4%BA%8E%E4%BA%86%E5%93%AA%E4%BA%9B%E5%B7%A5%E5%85%B7%E4%B8%8A%E5%8F%91%E5%B1%95%E8%80%8C%E6%9D%A5"><span class="toc-text">Arthas基于了哪些工具上发展而来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E7%B1%BB%E5%B7%A5%E5%85%B7%E6%9C%89%E5%93%AA%E4%BA%9B"><span class="toc-text">同类工具有哪些</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Arthas%E5%85%A5%E9%97%A8"><span class="toc-text">Arthas入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Arthas-%E4%B8%8A%E6%89%8B%E5%89%8D"><span class="toc-text">Arthas 上手前</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arthas-%E5%AE%89%E8%A3%85"><span class="toc-text">Arthas 安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arthas-%E5%AE%98%E6%96%B9%E6%A1%88%E4%BE%8B%E5%B1%95%E7%A4%BA"><span class="toc-text">Arthas 官方案例展示</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Dashboard"><span class="toc-text">Dashboard</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thread"><span class="toc-text">Thread</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jad"><span class="toc-text">jad</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mc"><span class="toc-text">mc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#redefine"><span class="toc-text">redefine</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sc"><span class="toc-text">sc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#stack"><span class="toc-text">stack</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Trace"><span class="toc-text">Trace</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Watch"><span class="toc-text">Watch</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Monitor"><span class="toc-text">Monitor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Time-Tunnel-tt"><span class="toc-text">Time Tunnel(tt)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Classloader"><span class="toc-text">Classloader</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Web-Console"><span class="toc-text">Web Console</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arthas-%E5%91%BD%E4%BB%A4%E9%9B%86"><span class="toc-text">Arthas 命令集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4"><span class="toc-text">基础命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jvm%E7%9B%B8%E5%85%B3"><span class="toc-text">jvm相关</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#class-classloader%E7%9B%B8%E5%85%B3"><span class="toc-text">class&#x2F;classloader相关</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#monitor-watch-trace%E7%9B%B8%E5%85%B3"><span class="toc-text">monitor&#x2F;watch&#x2F;trace相关</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#options"><span class="toc-text">options</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%A1%E9%81%93"><span class="toc-text">管道</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1"><span class="toc-text">后台异步任务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Web-Console-1"><span class="toc-text">Web Console</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%9B%9E%E6%8A%A5"><span class="toc-text">用户数据回报</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%89%B9%E6%80%A7"><span class="toc-text">其他特性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Arthas%E5%9C%BA%E6%99%AF%E5%AE%9E%E6%88%98"><span class="toc-text">Arthas场景实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%9C%80%E7%B9%81%E5%BF%99%E7%9A%84%E7%BA%BF%E7%A8%8B%EF%BC%8C%E4%BB%A5%E5%8F%8A%E6%98%AF%E5%90%A6%E6%9C%89%E9%98%BB%E5%A1%9E%E6%83%85%E5%86%B5%E5%8F%91%E7%94%9F"><span class="toc-text">查看最繁忙的线程，以及是否有阻塞情况发生?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E8%AE%A4%E6%9F%90%E4%B8%AA%E7%B1%BB%E6%98%AF%E5%90%A6%E5%B7%B2%E8%A2%AB%E7%B3%BB%E7%BB%9F%E5%8A%A0%E8%BD%BD"><span class="toc-text">确认某个类是否已被系统加载?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%E4%B8%80%E4%B8%AAclass%E7%B1%BB%E7%9A%84%E6%BA%90%E7%A0%81%E4%BF%A1%E6%81%AF"><span class="toc-text">如何查看一个class类的源码信息?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E8%A6%81%EF%BC%9A%E5%A6%82%E4%BD%95%E8%B7%9F%E8%B8%AA%E6%9F%90%E4%B8%AA%E6%96%B9%E6%B3%95%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC%E3%80%81%E5%85%A5%E5%8F%82%E2%80%A6"><span class="toc-text">重要：如何跟踪某个方法的返回值、入参…. ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E7%9C%8B%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E6%A0%88%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="toc-text">如何看方法调用栈的信息?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E8%A6%81%EF%BC%9A%E6%89%BE%E5%88%B0%E6%9C%80%E8%80%97%E6%97%B6%E7%9A%84%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8"><span class="toc-text">重要：找到最耗时的方法调用?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E8%A6%81%EF%BC%9A%E5%A6%82%E4%BD%95%E4%B8%B4%E6%97%B6%E6%9B%B4%E6%94%B9%E4%BB%A3%E7%A0%81%E8%BF%90%E8%A1%8C"><span class="toc-text">重要：如何临时更改代码运行?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E5%A6%82%E4%BD%95%E6%B5%8B%E8%AF%95%E6%9F%90%E4%B8%AA%E6%96%B9%E6%B3%95%E7%9A%84%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98"><span class="toc-text">我如何测试某个方法的性能问题?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E5%A4%9A"><span class="toc-text">更多</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Arthas%E6%BA%90%E7%A0%81"><span class="toc-text">Arthas源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-text">参考资料</span></a></li></ol></div></div></widget>




</div>


    </aside>
    <div class='l_main'>
      

      



<div class="bread-nav fs12"><div class="left"><div id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a><span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/Java/">Java</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/Java/JVM/">JVM</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/Java/JVM/%E8%B0%83%E8%AF%95%E6%8E%92%E9%94%99/">调试排错</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/Java/JVM/%E8%B0%83%E8%AF%95%E6%8E%92%E9%94%99/%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/">问题排查</a></div><div id="post-meta">
    <span>发布于&nbsp;<time datetime="2023-12-27T07:41:20.000Z">2023-12-27</time></span>
    
    <span>更新于&nbsp;<time datetime="2023-12-27T07:41:20.000Z">2023-12-27</time></span>
    </div></div></div>

<article class='md-text content post'>
<h1 class="article-title"><span>19.调试排错 - Java 问题排查之应用在线调试Arthas</span></h1>
<blockquote>
<p>本文主要介绍Alibaba开源的Java诊断工具，开源到现在已经几万个点赞了，深受开发者喜爱。</p>
</blockquote>
<h2 id="Arthas简介"><a href="#Arthas简介" class="headerlink" title="Arthas简介"></a>Arthas简介</h2><blockquote>
<p>在学习Arthas之前，推荐先看上一篇美团技术团队的<a href="">Java 动态调试技术原理及实践</a>，这样你会对它最底层技术有个了解。可以看下文中最后有个对比图：Greys(Arthas也是基于它做的二次开发)和Java-debug-tool。</p>
</blockquote>
<h3 id="Arthas是什么"><a href="#Arthas是什么" class="headerlink" title="Arthas是什么"></a>Arthas是什么</h3><p><code>Arthas</code> 是Alibaba开源的Java诊断工具，深受开发者喜爱。</p>
<h3 id="Arthas能解决什么问题"><a href="#Arthas能解决什么问题" class="headerlink" title="Arthas能解决什么问题"></a>Arthas能解决什么问题</h3><p>当你遇到以下类似问题而束手无策时，<code>Arthas</code>可以帮助你解决：</p>
<ul>
<li>这个类从哪个 jar 包加载的? 为什么会报各种类相关的 Exception?</li>
<li>我改的代码为什么没有执行到? 难道是我没 commit? 分支搞错了?</li>
<li>遇到问题无法在线上 debug，难道只能通过加日志再重新发布吗?</li>
<li>线上遇到某个用户的数据处理有问题，但线上同样无法 debug，线下无法重现！</li>
<li>是否有一个全局视角来查看系统的运行状况?</li>
<li>有什么办法可以监控到JVM的实时运行状态?</li>
</ul>
<p><code>Arthas</code>支持JDK 6+，支持Linux&#x2F;Mac&#x2F;Windows，采用命令行交互模式，同时提供丰富的 <code>Tab</code> 自动补全功能，进一步方便进行问题的定位和诊断。</p>
<h3 id="Arthas资源推荐"><a href="#Arthas资源推荐" class="headerlink" title="Arthas资源推荐"></a>Arthas资源推荐</h3><ul>
<li><a target="_blank" rel="noopener" href="https://alibaba.github.io/arthas/">用户文档</a></li>
<li><a target="_blank" rel="noopener" href="https://alibaba.github.io/arthas/arthas-tutorials?language=cn">官方在线教程(推荐)</a></li>
<li><a target="_blank" rel="noopener" href="https://alibaba.github.io/arthas/quick-start.html">快速入门</a></li>
<li><a target="_blank" rel="noopener" href="https://alibaba.github.io/arthas/advanced-use.html">进阶使用</a></li>
<li><a target="_blank" rel="noopener" href="https://alibaba.github.io/arthas/commands.html">命令列表</a></li>
<li><a target="_blank" rel="noopener" href="https://alibaba.github.io/arthas/web-console.html">WebConsole</a></li>
<li><a target="_blank" rel="noopener" href="https://alibaba.github.io/arthas/docker.html">Docker</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/issues?q=label:user-case">用户案例</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/issues?utf8=%E2%9C%93&q=label:question-answered+">常见问题</a></li>
</ul>
<h3 id="Arthas基于了哪些工具上发展而来"><a href="#Arthas基于了哪些工具上发展而来" class="headerlink" title="Arthas基于了哪些工具上发展而来"></a>Arthas基于了哪些工具上发展而来</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/oldmanpushcart/greys-anatomy">greys-anatomy</a>: Arthas代码基于Greys二次开发而来，非常感谢Greys之前所有的工作，以及Greys原作者对Arthas提出的意见和建议！</li>
<li><a target="_blank" rel="noopener" href="https://github.com/termd/termd">termd</a>: Arthas的命令行实现基于termd开发，是一款优秀的命令行程序开发框架，感谢termd提供了优秀的框架。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/crashub/crash">crash</a>: Arthas的文本渲染功能基于crash中的文本渲染功能开发，可以从<a target="_blank" rel="noopener" href="https://github.com/crashub/crash/tree/1.3.2/shell">这里</a>看到源码，感谢crash在这方面所做的优秀工作。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/eclipse-vertx/vert.x/tree/master/src/main/java/io/vertx/core/cli">cli</a>: Arthas的命令行界面基于vert.x提供的cli库进行开发，感谢vert.x在这方面做的优秀工作。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/skalogs/SkaETL/tree/master/compiler">compiler</a> Arthas里的内存编绎器代码来源</li>
<li><a target="_blank" rel="noopener" href="https://commons.apache.org/proper/commons-net/">Apache Commons Net</a> Arthas里的Telnet Client代码来源</li>
<li><code>JavaAgent</code>：运行在 main方法之前的拦截器，它内定的方法名叫 premain ，也就是说先执行 premain 方法然后再执行 main 方法</li>
<li><code>ASM</code>：一个通用的Java字节码操作和分析框架。它可以用于修改现有的类或直接以二进制形式动态生成类。ASM提供了一些常见的字节码转换和分析算法，可以从它们构建定制的复杂转换和代码分析工具。ASM提供了与其他Java字节码框架类似的功能，但是主要关注性能。因为它被设计和实现得尽可能小和快，所以非常适合在动态系统中使用(当然也可以以静态方式使用，例如在编译器中)</li>
</ul>
<h3 id="同类工具有哪些"><a href="#同类工具有哪些" class="headerlink" title="同类工具有哪些"></a>同类工具有哪些</h3><ul>
<li>BTrace</li>
<li>美团 Java-debug-tool</li>
<li><a target="_blank" rel="noopener" href="https://github.com/qunarcorp/bistoury">去哪儿Bistoury: 一个集成了Arthas的项目</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/XhinLiang/arthas">一个使用MVEL脚本的fork</a></li>
</ul>
<h2 id="Arthas入门"><a href="#Arthas入门" class="headerlink" title="Arthas入门"></a>Arthas入门</h2><h3 id="Arthas-上手前"><a href="#Arthas-上手前" class="headerlink" title="Arthas 上手前"></a>Arthas 上手前</h3><p>推荐先在线使用下arthas：<a target="_blank" rel="noopener" href="https://alibaba.github.io/arthas/arthas-tutorials?language=cn">官方在线教程(推荐)</a></p>
<h3 id="Arthas-安装"><a href="#Arthas-安装" class="headerlink" title="Arthas 安装"></a>Arthas 安装</h3><p>下载<code>arthas-boot.jar</code>，然后用<code>java -jar</code>的方式启动：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -O https://alibaba.github.io/arthas/arthas-boot.jar</span><br><span class="line">java -jar arthas-boot.jar</span><br></pre></td></tr></table></figure>

<h3 id="Arthas-官方案例展示"><a href="#Arthas-官方案例展示" class="headerlink" title="Arthas 官方案例展示"></a>Arthas 官方案例展示</h3><h4 id="Dashboard"><a href="#Dashboard" class="headerlink" title="Dashboard"></a>Dashboard</h4><ul>
<li><a target="_blank" rel="noopener" href="https://alibaba.github.io/arthas/dashboard">https://alibaba.github.io/arthas/dashboard</a></li>
</ul>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/HubertWongCN/image_host/img/202312271543066.png"/></div></div>

<h4 id="Thread"><a href="#Thread" class="headerlink" title="Thread"></a>Thread</h4><p>一目了然的了解系统的状态，哪些线程比较占cpu? 他们到底在做什么?</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ thread -n 3</span><br><span class="line"><span class="string">&quot;as-command-execute-daemon&quot;</span> Id=29 cpuUsage=75% RUNNABLE</span><br><span class="line">    at sun.management.ThreadImpl.dumpThreads0(Native Method)</span><br><span class="line">    at sun.management.ThreadImpl.getThreadInfo(ThreadImpl.java:440)</span><br><span class="line">    at com.taobao.arthas.core.command.monitor200.ThreadCommand<span class="variable">$1</span>.action(ThreadCommand.java:58)</span><br><span class="line">    at com.taobao.arthas.core.command.handler.AbstractCommandHandler.execute(AbstractCommandHandler.java:238)</span><br><span class="line">    at com.taobao.arthas.core.command.handler.DefaultCommandHandler.handleCommand(DefaultCommandHandler.java:67)</span><br><span class="line">    at com.taobao.arthas.core.server.ArthasServer<span class="variable">$4</span>.run(ArthasServer.java:276)</span><br><span class="line">    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)</span><br><span class="line">    at java.util.concurrent.ThreadPoolExecutor<span class="variable">$Worker</span>.run(ThreadPoolExecutor.java:615)</span><br><span class="line">    at java.lang.Thread.run(Thread.java:745)</span><br><span class="line"></span><br><span class="line">    Number of locked synchronizers = 1</span><br><span class="line">    - java.util.concurrent.ThreadPoolExecutor<span class="variable">$Worker</span>@6cd0b6f8</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;as-session-expire-daemon&quot;</span> Id=25 cpuUsage=24% TIMED_WAITING</span><br><span class="line">    at java.lang.Thread.<span class="built_in">sleep</span>(Native Method)</span><br><span class="line">    at com.taobao.arthas.core.server.DefaultSessionManager<span class="variable">$2</span>.run(DefaultSessionManager.java:85)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;Reference Handler&quot;</span> Id=2 cpuUsage=0% WAITING on java.lang.ref.Reference<span class="variable">$Lock</span>@69ba0f27</span><br><span class="line">    at java.lang.Object.<span class="built_in">wait</span>(Native Method)</span><br><span class="line">    -  waiting on java.lang.ref.Reference<span class="variable">$Lock</span>@69ba0f27</span><br><span class="line">    at java.lang.Object.<span class="built_in">wait</span>(Object.java:503)</span><br><span class="line">    at java.lang.ref.Reference<span class="variable">$ReferenceHandler</span>.run(Reference.java:133)</span><br></pre></td></tr></table></figure>

<h4 id="jad"><a href="#jad" class="headerlink" title="jad"></a>jad</h4><p>对类进行反编译:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">$ jad javax.servlet.Servlet</span><br><span class="line"></span><br><span class="line">ClassLoader:</span><br><span class="line">+-java.net.URLClassLoader@6108b2d7</span><br><span class="line">  +-sun.misc.Launcher$AppClassLoader@18b4aac2</span><br><span class="line">    +-sun.misc.Launcher$ExtClassLoader@1ddf84b8</span><br><span class="line"></span><br><span class="line">Location:</span><br><span class="line">/Users/xxx/work/test/lib/servlet-api.jar</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Decompiled with CFR 0_122.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">package</span> javax.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Servlet</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig var1)</span> <span class="keyword">throws</span> ServletException;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest var1, ServletResponse var2)</span> <span class="keyword">throws</span> ServletException, IOException;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getServletInfo</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="mc"><a href="#mc" class="headerlink" title="mc"></a>mc</h4><p>Memory Compiler&#x2F;内存编译器，编译<code>.java</code>文件生成<code>.class</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mc /tmp/Test.java</span><br></pre></td></tr></table></figure>

<h4 id="redefine"><a href="#redefine" class="headerlink" title="redefine"></a>redefine</h4><p>加载外部的<code>.class</code>文件，redefine jvm已加载的类。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redefine /tmp/Test.class</span><br><span class="line">redefine -c 327a647b /tmp/Test.class /tmp/Test\<span class="variable">$Inner</span>.class</span><br></pre></td></tr></table></figure>

<h4 id="sc"><a href="#sc" class="headerlink" title="sc"></a>sc</h4><p>查找JVM中已经加载的类</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$ sc -d org.springframework.web.context.support.XmlWebApplicationContext</span><br><span class="line"> class-info        org.springframework.web.context.support.XmlWebApplicationContext</span><br><span class="line"> code-source       /Users/xxx/work/test/WEB-INF/lib/spring-web-3.2.11.RELEASE.jar</span><br><span class="line"> name              org.springframework.web.context.support.XmlWebApplicationContext</span><br><span class="line"> isInterface       <span class="literal">false</span></span><br><span class="line"> isAnnotation      <span class="literal">false</span></span><br><span class="line"> isEnum            <span class="literal">false</span></span><br><span class="line"> isAnonymousClass  <span class="literal">false</span></span><br><span class="line"> isArray           <span class="literal">false</span></span><br><span class="line"> isLocalClass      <span class="literal">false</span></span><br><span class="line"> isMemberClass     <span class="literal">false</span></span><br><span class="line"> isPrimitive       <span class="literal">false</span></span><br><span class="line"> isSynthetic       <span class="literal">false</span></span><br><span class="line"> simple-name       XmlWebApplicationContext</span><br><span class="line"> modifier          public</span><br><span class="line"> annotation</span><br><span class="line"> interfaces</span><br><span class="line"> super-class       +-org.springframework.web.context.support.AbstractRefreshableWebApplicationContext</span><br><span class="line">                     +-org.springframework.context.support.AbstractRefreshableConfigApplicationContext</span><br><span class="line">                       +-org.springframework.context.support.AbstractRefreshableApplicationContext</span><br><span class="line">                         +-org.springframework.context.support.AbstractApplicationContext</span><br><span class="line">                           +-org.springframework.core.io.DefaultResourceLoader</span><br><span class="line">                             +-java.lang.Object</span><br><span class="line"> class-loader      +-org.apache.catalina.loader.ParallelWebappClassLoader</span><br><span class="line">                     +-java.net.URLClassLoader@6108b2d7</span><br><span class="line">                       +-sun.misc.Launcher<span class="variable">$AppClassLoader</span>@18b4aac2</span><br><span class="line">                         +-sun.misc.Launcher<span class="variable">$ExtClassLoader</span>@1ddf84b8</span><br><span class="line"> classLoaderHash   25131501</span><br></pre></td></tr></table></figure>

<h4 id="stack"><a href="#stack" class="headerlink" title="stack"></a>stack</h4><p>查看方法 <code>test.arthas.TestStack#doGet</code> 的调用堆栈：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$ stack test.arthas.TestStack doGet</span><br><span class="line">Press Ctrl+C to abort.</span><br><span class="line">Affect(class-cnt:1 , method-cnt:1) cost <span class="keyword">in</span> 286 ms.</span><br><span class="line">ts=2018-09-18 10:11:45;thread_name=http-bio-8080-exec-10;<span class="built_in">id</span>=d9;is_daemon=<span class="literal">true</span>;priority=5;TCCL=org.apache.catalina.loader.ParallelWebappClassLoader@25131501</span><br><span class="line">    @test.arthas.TestStack.doGet()</span><br><span class="line">        at javax.servlet.http.HttpServlet.service(HttpServlet.java:624)</span><br><span class="line">        at javax.servlet.http.HttpServlet.service(HttpServlet.java:731)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)</span><br><span class="line">        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)</span><br><span class="line">        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)</span><br><span class="line">        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:110)</span><br><span class="line">        ...</span><br><span class="line">        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:169)</span><br><span class="line">        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)</span><br><span class="line">        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)</span><br><span class="line">        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:451)</span><br><span class="line">        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1121)</span><br><span class="line">        at org.apache.coyote.AbstractProtocol<span class="variable">$AbstractConnectionHandler</span>.process(AbstractProtocol.java:637)</span><br><span class="line">        at org.apache.tomcat.util.net.JIoEndpoint<span class="variable">$SocketProcessor</span>.run(JIoEndpoint.java:316)</span><br><span class="line">        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)</span><br><span class="line">        at java.util.concurrent.ThreadPoolExecutor<span class="variable">$Worker</span>.run(ThreadPoolExecutor.java:617)</span><br><span class="line">        at org.apache.tomcat.util.threads.TaskThread<span class="variable">$WrappingRunnable</span>.run(TaskThread.java:61)</span><br><span class="line">        at java.lang.Thread.run(Thread.java:745)</span><br></pre></td></tr></table></figure>

<h4 id="Trace"><a href="#Trace" class="headerlink" title="Trace"></a>Trace</h4><p>观察方法执行的时候哪个子调用比较慢:</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/HubertWongCN/image_host/img/202312271544902.png"/></div></div>

<h4 id="Watch"><a href="#Watch" class="headerlink" title="Watch"></a>Watch</h4><p>观察方法 <code>test.arthas.TestWatch#doGet</code> 执行的入参，仅当方法抛出异常时才输出。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ watch test.arthas.TestWatch doGet &#123;params[0], throwExp&#125; -e</span><br><span class="line">Press Ctrl+C to abort.</span><br><span class="line">Affect(class-cnt:1 , method-cnt:1) cost <span class="keyword">in</span> 65 ms.</span><br><span class="line">ts=2018-09-18 10:26:28;result=@ArrayList[</span><br><span class="line">    @RequestFacade[org.apache.catalina.connector.RequestFacade@79f922b2],</span><br><span class="line">    @NullPointerException[java.lang.NullPointerException],</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="Monitor"><a href="#Monitor" class="headerlink" title="Monitor"></a>Monitor</h4><p>监控某个特殊方法的调用统计数据，包括总调用次数，平均rt，成功率等信息，每隔5秒输出一次。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ monitor -c 5 org.apache.dubbo.demo.provider.DemoServiceImpl sayHello</span><br><span class="line">Press Ctrl+C to abort.</span><br><span class="line">Affect(class-cnt:1 , method-cnt:1) cost <span class="keyword">in</span> 109 ms.</span><br><span class="line"> timestamp            class                                           method    total  success  fail  avg-rt(ms)  fail-rate</span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"> 2018-09-20 09:45:32  org.apache.dubbo.demo.provider.DemoServiceImpl  sayHello  5      5        0     0.67        0.00%</span><br><span class="line"></span><br><span class="line"> timestamp            class                                           method    total  success  fail  avg-rt(ms)  fail-rate</span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"> 2018-09-20 09:45:37  org.apache.dubbo.demo.provider.DemoServiceImpl  sayHello  5      5        0     1.00        0.00%</span><br><span class="line"></span><br><span class="line"> timestamp            class                                           method    total  success  fail  avg-rt(ms)  fail-rate</span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"> 2018-09-20 09:45:42  org.apache.dubbo.demo.provider.DemoServiceImpl  sayHello  5      5        0     0.43        0.00%</span><br></pre></td></tr></table></figure>

<h4 id="Time-Tunnel-tt"><a href="#Time-Tunnel-tt" class="headerlink" title="Time Tunnel(tt)"></a>Time Tunnel(tt)</h4><p>记录方法调用信息，支持事后查看方法调用的参数，返回值，抛出的异常等信息，仿佛穿越时空隧道回到调用现场一般。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ tt -t org.apache.dubbo.demo.provider.DemoServiceImpl sayHello</span><br><span class="line">Press Ctrl+C to abort.</span><br><span class="line">Affect(class-cnt:1 , method-cnt:1) cost <span class="keyword">in</span> 75 ms.</span><br><span class="line"> INDEX   TIMESTAMP            COST(ms)  IS-RET  IS-EXP   OBJECT         CLASS                          METHOD</span><br><span class="line">-------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"> 1000    2018-09-20 09:54:10  1.971195  <span class="literal">true</span>    <span class="literal">false</span>    0x55965cca     DemoServiceImpl                sayHello</span><br><span class="line"> 1001    2018-09-20 09:54:11  0.215685  <span class="literal">true</span>    <span class="literal">false</span>    0x55965cca     DemoServiceImpl                sayHello</span><br><span class="line"> 1002    2018-09-20 09:54:12  0.236303  <span class="literal">true</span>    <span class="literal">false</span>    0x55965cca     DemoServiceImpl                sayHello</span><br><span class="line"> 1003    2018-09-20 09:54:13  0.159598  <span class="literal">true</span>    <span class="literal">false</span>    0x55965cca     DemoServiceImpl                sayHello</span><br><span class="line"> 1004    2018-09-20 09:54:14  0.201982  <span class="literal">true</span>    <span class="literal">false</span>    0x55965cca     DemoServiceImpl                sayHello</span><br><span class="line"> 1005    2018-09-20 09:54:15  0.214205  <span class="literal">true</span>    <span class="literal">false</span>    0x55965cca     DemoServiceImpl                sayHello</span><br><span class="line"> 1006    2018-09-20 09:54:16  0.241863  <span class="literal">true</span>    <span class="literal">false</span>    0x55965cca     DemoServiceImpl                sayHello</span><br><span class="line"> 1007    2018-09-20 09:54:17  0.305747  <span class="literal">true</span>    <span class="literal">false</span>    0x55965cca     DemoServiceImpl                sayHello</span><br><span class="line"> 1008    2018-09-20 09:54:18  0.18468   <span class="literal">true</span>    <span class="literal">false</span>    0x55965cca     DemoServiceImpl                sayHello</span><br></pre></td></tr></table></figure>

<h4 id="Classloader"><a href="#Classloader" class="headerlink" title="Classloader"></a>Classloader</h4><p>了解当前系统中有多少类加载器，以及每个加载器加载的类数量，帮助您判断是否有类加载器泄露。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ classloader</span><br><span class="line"> name                                                  numberOfInstances  loadedCountTotal</span><br><span class="line"> BootstrapClassLoader                                  1                  3346</span><br><span class="line"> com.taobao.arthas.agent.ArthasClassloader             1                  1262</span><br><span class="line"> java.net.URLClassLoader                               2                  1033</span><br><span class="line"> org.apache.catalina.loader.ParallelWebappClassLoader  1                  628</span><br><span class="line"> sun.reflect.DelegatingClassLoader                     166                166</span><br><span class="line"> sun.misc.Launcher<span class="variable">$AppClassLoader</span>                      1                  31</span><br><span class="line"> com.alibaba.fastjson.util.ASMClassLoader              6                  15</span><br><span class="line"> sun.misc.Launcher<span class="variable">$ExtClassLoader</span>                      1                  7</span><br><span class="line"> org.jvnet.hk2.internal.DelegatingClassLoader          2                  2</span><br><span class="line"> sun.reflect.misc.MethodUtil                           1                  1</span><br></pre></td></tr></table></figure>

<h4 id="Web-Console"><a href="#Web-Console" class="headerlink" title="Web Console"></a>Web Console</h4><ul>
<li><a target="_blank" rel="noopener" href="https://alibaba.github.io/arthas/web-console">https://alibaba.github.io/arthas/web-console</a></li>
</ul>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/HubertWongCN/image_host/img/202312271545478.png"/></div></div>

<h3 id="Arthas-命令集"><a href="#Arthas-命令集" class="headerlink" title="Arthas 命令集"></a>Arthas 命令集</h3><h4 id="基础命令"><a href="#基础命令" class="headerlink" title="基础命令"></a>基础命令</h4><ul>
<li>help——查看命令帮助信息</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/cat.md">cat</a>——打印文件内容，和linux里的cat命令类似</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/grep.md">grep</a>——匹配查找，和linux里的grep命令类似</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/pwd.md">pwd</a>——返回当前的工作目录，和linux命令类似</li>
<li>cls——清空当前屏幕区域</li>
<li>session——查看当前会话的信息</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/reset.md">reset</a>——重置增强类，将被 Arthas 增强过的类全部还原，Arthas 服务端关闭时会重置所有增强过的类</li>
<li>version——输出当前目标 Java 进程所加载的 Arthas 版本号</li>
<li>history——打印命令历史</li>
<li>quit——退出当前 Arthas 客户端，其他 Arthas 客户端不受影响</li>
<li>stop&#x2F;shutdown——关闭 Arthas 服务端，所有 Arthas 客户端全部退出</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/keymap.md">keymap</a>——Arthas快捷键列表及自定义快捷键</li>
</ul>
<h4 id="jvm相关"><a href="#jvm相关" class="headerlink" title="jvm相关"></a>jvm相关</h4><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/dashboard.md">dashboard</a>——当前系统的实时数据面板</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/thread.md">thread</a>——查看当前 JVM 的线程堆栈信息</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/jvm.md">jvm</a>——查看当前 JVM 的信息</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/sysprop.md">sysprop</a>——查看和修改JVM的系统属性</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/sysenv.md">sysenv</a>——查看JVM的环境变量</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/vmoption.md">vmoption</a>——查看和修改JVM里诊断相关的option</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/logger.md">logger</a>——查看和修改logger</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/getstatic.md">getstatic</a>——查看类的静态属性</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/ognl.md">ognl</a>——执行ognl表达式</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/mbean.md">mbean</a>——查看 Mbean 的信息</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/heapdump.md">heapdump</a>——dump java heap, 类似jmap命令的heap dump功能</li>
</ul>
<h4 id="class-classloader相关"><a href="#class-classloader相关" class="headerlink" title="class&#x2F;classloader相关"></a>class&#x2F;classloader相关</h4><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/sc.md">sc</a>——查看JVM已加载的类信息</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/sm.md">sm</a>——查看已加载类的方法信息</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/jad.md">jad</a>——反编译指定已加载类的源码</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/mc.md">mc</a>——内存编绎器，内存编绎<code>.java</code>文件为<code>.class</code>文件</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/redefine.md">redefine</a>——加载外部的<code>.class</code>文件，redefine到JVM里</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/dump.md">dump</a>——dump 已加载类的 byte code 到特定目录</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/classloader.md">classloader</a>——查看classloader的继承树，urls，类加载信息，使用classloader去getResource</li>
</ul>
<h4 id="monitor-watch-trace相关"><a href="#monitor-watch-trace相关" class="headerlink" title="monitor&#x2F;watch&#x2F;trace相关"></a>monitor&#x2F;watch&#x2F;trace相关</h4><blockquote>
<p>请注意，这些命令，都通过字节码增强技术来实现的，会在指定类的方法中插入一些切面来实现数据统计和观测，因此在线上、预发使用时，请尽量明确需要观测的类、方法以及条件，诊断结束要执行 <code>shutdown</code> 或将增强过的类执行 <code>reset</code> 命令。</p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/monitor.md">monitor</a>——方法执行监控</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/watch.md">watch</a>——方法执行数据观测</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/trace.md">trace</a>——方法内部调用路径，并输出方法路径上的每个节点上耗时</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/stack.md">stack</a>——输出当前方法被调用的调用路径</li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/tt.md">tt</a>——方法执行数据的时空隧道，记录下指定方法每次调用的入参和返回信息，并能对这些不同的时间下调用进行观测</li>
</ul>
<h4 id="options"><a href="#options" class="headerlink" title="options"></a>options</h4><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/options.md">options</a>——查看或设置Arthas全局开关</li>
</ul>
<h4 id="管道"><a href="#管道" class="headerlink" title="管道"></a>管道</h4><p>Arthas支持使用管道对上述命令的结果进行进一步的处理，如<code>sm java.lang.String * | grep &#39;index&#39;</code></p>
<ul>
<li>grep——搜索满足条件的结果</li>
<li>plaintext——将命令的结果去除ANSI颜色</li>
<li>wc——按行统计输出结果</li>
</ul>
<h4 id="后台异步任务"><a href="#后台异步任务" class="headerlink" title="后台异步任务"></a>后台异步任务</h4><p>当线上出现偶发的问题，比如需要watch某个条件，而这个条件一天可能才会出现一次时，异步后台任务就派上用场了，详情请参考<a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/async.md">这里</a></p>
<ul>
<li>使用 &gt; 将结果重写向到日志文件，使用 &amp; 指定命令是后台运行，session断开不影响任务执行(生命周期默认为1天)</li>
<li>jobs——列出所有job</li>
<li>kill——强制终止任务</li>
<li>fg——将暂停的任务拉到前台执行</li>
<li>bg——将暂停的任务放到后台执行</li>
</ul>
<h4 id="Web-Console-1"><a href="#Web-Console-1" class="headerlink" title="Web Console"></a>Web Console</h4><p>通过websocket连接Arthas。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/web-console.md">Web Console</a></li>
</ul>
<h4 id="用户数据回报"><a href="#用户数据回报" class="headerlink" title="用户数据回报"></a>用户数据回报</h4><p>在<code>3.1.4</code>版本后，增加了用户数据回报功能，方便统一做安全或者历史数据统计。</p>
<p>在启动时，指定<code>stat-url</code>，就会回报执行的每一行命令，比如： <code>./as.sh --stat-url &#39;http://192.168.10.11:8080/api/stat&#39;</code></p>
<p>在tunnel server里有一个示例的回报代码，用户可以自己在服务器上实现。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/https://github.com/alibaba/arthas/blob/master/tunnel-server/src/main/java/com/alibaba/arthas/tunnel/server/app/web/StatController.java">StatController.java</a></p>
<h4 id="其他特性"><a href="#其他特性" class="headerlink" title="其他特性"></a>其他特性</h4><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/async.md">异步命令支持</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/save-log.md">执行结果存日志</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/batch-support.md">批处理的支持</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/blob/master/site/src/site/sphinx/https://github.com/alibaba/arthas/issues/11">ognl表达式的用法说明</a></li>
</ul>
<h2 id="Arthas场景实战"><a href="#Arthas场景实战" class="headerlink" title="Arthas场景实战"></a>Arthas场景实战</h2><h3 id="查看最繁忙的线程，以及是否有阻塞情况发生"><a href="#查看最繁忙的线程，以及是否有阻塞情况发生" class="headerlink" title="查看最繁忙的线程，以及是否有阻塞情况发生?"></a>查看最繁忙的线程，以及是否有阻塞情况发生?</h3><blockquote>
<p>场景：我想看下查看最繁忙的线程，以及是否有阻塞情况发生? 常规查看线程，一般我们可以通过 top 等系统命令进行查看，但是那毕竟要很多个步骤，很麻烦。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">thread -n 3 <span class="comment"># 查看最繁忙的三个线程栈信息</span></span><br><span class="line">thread  <span class="comment"># 以直观的方式展现所有的线程情况</span></span><br><span class="line">thread -b <span class="comment">#找出当前阻塞其他线程的线程</span></span><br></pre></td></tr></table></figure>

<h3 id="确认某个类是否已被系统加载"><a href="#确认某个类是否已被系统加载" class="headerlink" title="确认某个类是否已被系统加载?"></a>确认某个类是否已被系统加载?</h3><blockquote>
<p>场景：我新写了一个类或者一个方法，我想知道新写的代码是否被部署了?</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 即可以找到需要的类全路径，如果存在的话</span></span><br><span class="line">sc *MyServlet</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看这个某个类所有的方法</span></span><br><span class="line">sm org.tech.servlet.TestMyServlet *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看某个方法的信息，如果存在的话</span></span><br><span class="line">sm org.tech.servlet.TestMyServlet testMethod  </span><br></pre></td></tr></table></figure>

<h3 id="如何查看一个class类的源码信息"><a href="#如何查看一个class类的源码信息" class="headerlink" title="如何查看一个class类的源码信息?"></a>如何查看一个class类的源码信息?</h3><blockquote>
<p>场景：我新修改的内容在方法内部，而上一个步骤只能看到方法，这时候可以反编译看下源码</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接反编译出java 源代码，包含一此额外信息的</span></span><br><span class="line">jad org.tech.servlet.TestMyServlet</span><br></pre></td></tr></table></figure>

<h3 id="重要：如何跟踪某个方法的返回值、入参…"><a href="#重要：如何跟踪某个方法的返回值、入参…" class="headerlink" title="重要：如何跟踪某个方法的返回值、入参…. ?"></a>重要：如何跟踪某个方法的返回值、入参…. ?</h3><blockquote>
<p>场景：我想看下我新加的方法在线运行的参数和返回值?</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同时监控入参，返回值，及异常</span></span><br><span class="line">watch org.tech.servlet.TestMyServlet testMethod <span class="string">&quot;&#123;params, returnObj, throwExp&#125;&quot;</span> -e -x 2 </span><br></pre></td></tr></table></figure>

<p>具体看watch命令。</p>
<h3 id="如何看方法调用栈的信息"><a href="#如何看方法调用栈的信息" class="headerlink" title="如何看方法调用栈的信息?"></a>如何看方法调用栈的信息?</h3><blockquote>
<p>场景：我想看下某个方法的调用栈的信息?</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stack org.tech.servlet.TestMyServlet testMethod</span><br></pre></td></tr></table></figure>

<p>运行此命令之后需要即时触发方法才会有响应的信息打印在控制台上</p>
<h3 id="重要：找到最耗时的方法调用"><a href="#重要：找到最耗时的方法调用" class="headerlink" title="重要：找到最耗时的方法调用?"></a>重要：找到最耗时的方法调用?</h3><blockquote>
<p>场景：testMethod这个方法入口响应很慢，如何找到最耗时的子调用?</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行的时候每个子调用的运行时长，可以找到最耗时的子调用。</span></span><br><span class="line">trace org.tech.servlet.TestMyServlet testMethod</span><br></pre></td></tr></table></figure>

<p>运行此命令之后需要即时触发方法才会有响应的信息打印在控制台上，然后一层一层看子调用。</p>
<h3 id="重要：如何临时更改代码运行"><a href="#重要：如何临时更改代码运行" class="headerlink" title="重要：如何临时更改代码运行?"></a>重要：如何临时更改代码运行?</h3><blockquote>
<p>场景：我找到了问题所在，能否线上直接修改测试，而不需要在本地改了代码后，重新打包部署，然后重启观察效果?</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先反编译出class源码</span></span><br><span class="line">jad --source-only com.example.demo.arthas.user.UserController &gt; /tmp/UserController.java  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后使用外部工具编辑内容</span></span><br><span class="line">mc /tmp/UserController.java -d /tmp  <span class="comment"># 再编译成class</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 最后，重新载入定义的类，就可以实时验证你的猜测了</span></span><br><span class="line">redefine /tmp/com/example/demo/arthas/user/UserController.class</span><br></pre></td></tr></table></figure>

<p>如上，是直接更改线上代码的方式，但是一般好像是编译不成功的。所以，最好是本地ide编译成 class文件后，再上传替换为好！</p>
<p>总之，已经完全不用重启和发布了！这个功能真的很方便，比起重启带来的代价，真的是不可比的。比如，重启时可能导致负载重分配，选主等等问题，就不是你能控制的了。</p>
<h3 id="我如何测试某个方法的性能问题"><a href="#我如何测试某个方法的性能问题" class="headerlink" title="我如何测试某个方法的性能问题?"></a>我如何测试某个方法的性能问题?</h3><blockquote>
<p>场景：我想看下某个方法的性能</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">monitor -c 5 demo.MathGame primeFactors</span><br></pre></td></tr></table></figure>

<h3 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h3><p>请参考: <a target="_blank" rel="noopener" href="https://github.com/alibaba/arthas/issues?q=label:user-case">官方Issue墙</a></p>
<h2 id="Arthas源码"><a href="#Arthas源码" class="headerlink" title="Arthas源码"></a>Arthas源码</h2><p>首先我们先放出一张整体宏观的模块调用图：</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/HubertWongCN/image_host/img/202312271548630.jpg"/></div></div>

<p>源码理解可以看移步这两篇文章:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/70c1c55f12ef">什么是 Arthas</a></li>
<li><a target="_blank" rel="noopener" href="https://yq.aliyun.com/articles/704228">Arthas阅读</a></li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/muxuanchan/p/10097639.html">https://www.cnblogs.com/muxuanchan/p/10097639.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yougewe/p/10770690.html">https://www.cnblogs.com/yougewe/p/10770690.html</a></li>
<li><a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/112975.html">https://help.aliyun.com/document_detail/112975.html</a></li>
</ul>



<div class="article-footer reveal fs14">
    <section id="license">
      <div class="header"><span>许可协议</span></div>
      <div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div>
    </section>
    </div>

</article>

<div class="related-wrap reveal" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/2023/12/27/20-%E8%B0%83%E8%AF%95%E6%8E%92%E9%94%99-Java-%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E4%B9%8B%E4%BD%BF%E7%94%A8IDEA%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E5%92%8C%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95/">20.调试排错 - Java 问题排查之使用IDEA本地调试和远程调试</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/2023/12/27/18-%E8%B0%83%E8%AF%95%E6%8E%92%E9%94%99-Java-%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E4%B9%8BJVM%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7/">18.调试排错 - Java 问题排查之JVM可视化工具</a></div></section></div>








      
<footer class="page-footer reveal fs12"><hr><div class="text"></div></footer>

      <div class='float-panel mobile-only blur' style='display:none'>
  <button type='button' class='sidebar-toggle mobile' onclick='sidebar.toggle()'>
    <svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"></path><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"></path></svg>
  </button>
</div>

    </div>
  </div>
  <div class='scripts'>
    <script type="text/javascript">
  const stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = stellar.config.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.version = '1.21.0';
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.21.0';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
    root : '/',
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://gcore.jsdelivr.net/npm/jquery@3.6.2/dist/jquery.min.js'
  };

  if ('local_search') {
    stellar.search = {};
    stellar.search.service = 'local_search';
    if (stellar.search.service == 'local_search') {
      let service_obj = Object.assign({}, {"field":"all","path":"/search.json","content":true,"sort":"-date"});
      stellar.search[stellar.search.service] = service_obj;
    }
  }

  // stellar js
  stellar.plugins.stellar = Object.assign({"sites":"/js/plugins/sites.js","friends":"/js/plugins/friends.js","ghinfo":"/js/plugins/ghinfo.js","timeline":"/js/plugins/timeline.js","linkcard":"/js/plugins/linkcard.js","fcircle":"/js/plugins/fcircle.js","weibo":"/js/plugins/weibo.js","memos":"/js/plugins/memos.js"});

  stellar.plugins.marked = Object.assign("https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js");
  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper@10.3/swiper-bundle.min.css","js":"https://unpkg.com/swiper@10.3/swiper-bundle.min.js"});
  }
  if ('' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":null,"js":"https://gcore.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://gcore.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://gcore.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.fancybox = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js","css":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css","selector":".swiper-slide img, .gallery img"});
  }
  if ('false' == 'true') {
    stellar.plugins.heti = Object.assign({"enable":false,"css":"https://unpkg.com/heti@0.9.2/umd/heti.min.css","js":"https://unpkg.com/heti@0.9.2/umd/heti-addon.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.copycode = Object.assign({"enable":true,"js":"/js/plugins/copycode.js","default_text":"Copy","success_text":"Copied"});
  }
</script>

<!-- required -->

  
<script src="/js/main.js" async></script>



<!-- optional -->



<!-- inject -->


  </div>
</body>
</html>
